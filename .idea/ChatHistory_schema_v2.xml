<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="ChatHistoryState">
    <option name="serializedSessions">
      <map>
        <entry key="03611d56-1cb8-45b0-9bf0-d7330dde66b4" value="{&quot;id&quot;:&quot;03611d56-1cb8-45b0-9bf0-d7330dde66b4&quot;,&quot;name&quot;:&quot;Debugging Kotlin Android App: Find the Error in MainActivity.kt&quot;,&quot;timestamp&quot;:1764254508855,&quot;messages&quot;:[{&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;text&quot;:&quot;\n\u003cadditional_data\u003e\nBelow are some potentially helpful/relevant pieces of information for figuring out to respond\n\u003ccurrent_file\u003e\n```kotlin:app/src/main/java/com/example/assignmenthub/MainActivity.kt, lines\u003dALL(1-126)\npackage com.example.assignmenthub\n\nimport android.content.Intent\nimport android.os.Bundle\nimport android.view.Menu\nimport android.widget.TextView\nimport androidx.appcompat.app.AppCompatActivity\nimport androidx.appcompat.app.AppCompatDelegate\nimport androidx.drawerlayout.widget.DrawerLayout\nimport androidx.navigation.findNavController\nimport androidx.navigation.ui.AppBarConfiguration\nimport androidx.navigation.ui.navigateUp\nimport androidx.navigation.ui.setupActionBarWithNavController\nimport androidx.navigation.ui.setupWithNavController\nimport com.example.assignmenthub.databinding.ActivityMainBinding\nimport com.google.android.material.navigation.NavigationView\nimport com.google.firebase.auth.FirebaseAuth\nimport com.google.firebase.database.DataSnapshot\nimport com.google.firebase.database.DatabaseError\nimport com.google.firebase.database.DatabaseReference\nimport com.google.firebase.database.FirebaseDatabase\nimport com.google.firebase.database.ValueEventListener\nimport androidx.core.content.edit\nimport androidx.appcompat.widget.Toolbar\n\nclass MainActivity : AppCompatActivity() {\n\n    private lateinit var appBarConfiguration: AppBarConfiguration\n    private lateinit var binding: ActivityMainBinding\n\n    private val auth \u003d FirebaseAuth.getInstance()\n    private val database \u003d FirebaseDatabase.getInstance()\n    private var userListener: ValueEventListener? \u003d null\n    private var userRef: DatabaseReference? \u003d null\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\n\n        val sharedPref \u003d getSharedPreferences(\&quot;UserSession\&quot;, MODE_PRIVATE)\n        val isLoggedIn \u003d sharedPref.getBoolean(\&quot;isLoggedIn\&quot;, false)\n        val currentUser \u003d auth.currentUser\n\n        if (!isLoggedIn || currentUser \u003d\u003d null) {\n            redirectToLogin()\n            return\n        }\n\n        binding \u003d ActivityMainBinding.inflate(layoutInflater)\n        setContentView(binding.root)\n\n        // Use findViewById to get the Toolbar\n        val toolbar \u003d findViewById\u003cToolbar\u003e(R.id.toolbar)\n        setSupportActionBar(toolbar)\n\n        val drawerLayout: DrawerLayout \u003d binding.drawerLayout\n        val navView: NavigationView \u003d binding.navView\n        val navController \u003d findNavController(R.id.nav_host_fragment_content_main)\n\n        appBarConfiguration \u003d AppBarConfiguration(\n            setOf(\n                R.id.nav_home, R.id.nav_profile, R.id.nav_uploads, R.id.nav_upload, R.id.log_out\n            ),\n            drawerLayout\n        )\n\n        setupActionBarWithNavController(navController, appBarConfiguration)\n        navView.setupWithNavController(navController)\n\n        val uid \u003d currentUser.uid\n        userRef \u003d database.reference.child(\&quot;users\&quot;).child(uid)\n\n        userListener \u003d object : ValueEventListener {\n            override fun onDataChange(snapshot: DataSnapshot) {\n                val username \u003d snapshot.child(\&quot;username\&quot;).getValue(String::class.java) ?: \&quot;Unknown User\&quot;\n                val headerView \u003d navView.getHeaderView(0)\n                val navUsername \u003d headerView.findViewById\u003cTextView\u003e(R.id.user_name)\n                navUsername.text \u003d username\n            }\n\n            override fun onCancelled(error: DatabaseError) {\n                // Handle error if needed\n            }\n        }\n\n        userRef?.addValueEventListener(userListener!!)\n\n        navView.setNavigationItemSelectedListener { menuItem -\u003e\n            when (menuItem.itemId) {\n                R.id.log_out -\u003e {\n                    sharedPref.edit { clear() }\n                    FirebaseAuth.getInstance().signOut()\n\n                    val intent \u003d Intent(this, LoginActivity::class.java).apply {\n                        flags \u003d Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK\n                    }\n                    startActivity(intent)\n                    finish()\n                    true\n                }\n                else -\u003e {\n                    navController.navigate(menuItem.itemId)\n                    drawerLayout.closeDrawers()\n                    true\n                }\n            }\n        }\n    }\n\n    private fun redirectToLogin() {\n        val intent \u003d Intent(this, LoginActivity::class.java)\n        intent.flags \u003d Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK\n        startActivity(intent)\n        finish()\n    }\n\n    override fun onCreateOptionsMenu(menu: Menu): Boolean {\n        menuInflater.inflate(R.menu.main, menu)\n        return true\n    }\n\n    override fun onSupportNavigateUp(): Boolean {\n        val navController \u003d findNavController(R.id.nav_host_fragment_content_main)\n        return navController.navigateUp(appBarConfiguration) || super.onSupportNavigateUp()\n    }\n}\n```\n\u003c/current_file\u003e\n\u003c/additional_data\u003e\n\u003cuser_query\u003e\nfind the error in the project , i will run it again\n\u003c/user_query\u003e&quot;}]},{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:[]}]}" />
      </map>
    </option>
  </component>
</project>